
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Expert-sourced, Bite-sized Restaurant Reviews - Codex</title>
  <meta name="author" content="Bruno Wu">

  
  <meta name="description" content="Expert-sourced, Bite-sized Restaurant Reviews Dec 26th, 2013 Problem There are many crowdsourced restaurant review sites already. For example, in &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://wubr2000.github.io/portfolio/Bites">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Codex" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!-- MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Codex</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="wubr2000@hotmail.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  


  <form method="get" action="/search.html">
    <fieldset role="search">
      <input class="search" name="query" type="text" placeholder="Search..." x-webkit-speech />
    </fieldset>
  </form>


<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/portfolio">Portfolio</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">Expert-sourced, Bite-sized Restaurant Reviews</h1>
    <p class="meta">








  


<time datetime="2013-12-26T07:21:00-08:00" pubdate data-updated="true">Dec 26<span>th</span>, 2013</time></p>
  </header>
  
  <h2 id="problem">Problem</h2>

<p>There are many crowdsourced restaurant review sites already. For example, in Hong Kong, we have <a href="http://www.openrice.com">Openrice</a>. In the US, there is Yelp. The reviews on these sites are usually ranked by popularity or the strength of social media connections. But the quality, reliability, credibility of these reviews are difficult to verify. At the other end of the spectrum, there are proprietary restaraunt review companies such as Michelin, Zagat, Timeout, etc. These are written and edited by very credible sources but they represent the view of a particular company or individual which could be biased.</p>

<h2 id="solution">Solution</h2>

<p><strong>I envisioned <a href="http://bitesize.herokuapp.com">Bites</a> to be the RottenTomatoes of restaurant reviews.</strong> It is a review site that is written/curated by dining experts only. While other users can comment and vote on each review, they can never start a review unless they have been verified as an expert by us. Bites will also be Twitter-like in that each review is only limited to 140 words. There will be upvotes/downvotes like Quora and a rigourous expertise verification system as well.</p>

<p>The incentive for experts to share their bite-sized review on this website is to promote their work or to enhance their reputation. This is the reason that <a href="http://www.quora.com">Quora</a> is able to attract experts to be top writers for their website.</p>

<h2 id="lessons">Lessons</h2>

<p><strong>The most important thing that I learned in this project is how to set up a &ldquo;following/followers&rdquo; data model - the backbone of any social network.</strong> This is done by creating a Relationship &ldquo;through-table&rdquo; that is also reversible.</p>

<p>This is how to set up the &ldquo;Relationship&rdquo; table in the User model:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class="line">  <span class="c1">#Relationship table for following:</span>
</span><span class="line">  <span class="n">has_many</span> <span class="ss">:relationships</span><span class="p">,</span> <span class="n">foreign_key</span><span class="p">:</span> <span class="s2">&quot;follower_id&quot;</span><span class="p">,</span> <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
</span><span class="line">  <span class="n">has_many</span> <span class="ss">:followed_users</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:relationships</span><span class="p">,</span> <span class="ss">source</span><span class="p">:</span> <span class="ss">:followed</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>By default, in a has_many through association Rails looks for a foreign key corresponding to the singular version of the association; in other words, code like &ldquo;has_many :followeds, through: :relationships&rdquo; would assemble an array using the followed_id in the relationships table. But, user.followeds is rather awkward; far more natural is to use &ldquo;followed users&rdquo; as a plural of &ldquo;followed&rdquo;, and write instead user.followed_users for the array of followed users. Naturally, Rails allows us to override the default, in this case using the :source parameter, which explicitly tells Rails that the source of the followed_users array is the set of followed ids.</p>

<p>This is how to set up the &ldquo;Reverse Relationship&rdquo; table for followers in the User model.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line">  <span class="c1">#Reverse relationship table for followers</span>
</span><span class="line">  <span class="n">has_many</span> <span class="ss">:reverse_relationships</span><span class="p">,</span>  <span class="n">foreign_key</span><span class="p">:</span> <span class="s2">&quot;followed_id&quot;</span><span class="p">,</span>
</span><span class="line">                                    <span class="n">class_name</span><span class="p">:</span> <span class="s2">&quot;Relationship&quot;</span><span class="p">,</span>
</span><span class="line">                                    <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
</span><span class="line">  <span class="n">has_many</span> <span class="ss">:followers</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:reverse_relationships</span><span class="p">,</span> <span class="ss">source</span><span class="p">:</span> <span class="ss">:follower</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It is not necessary to make a whole database table just to hold reverse relationships. Instead, take advantage of the underlying symmetry between followers and followed users to simulate a reverse_relationships table by passing followed_id as the primary key. Note that it is necessary to include the class name for this association:
&lt;div class=&#8217;bogus-wrapper&#8217;&gt;<notextile><figure class="code">&lt;figcaption&gt;<span></span>&lt;/figcaption&gt;&lt;div class=&#8221;highlight&#8221;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#8221;gutter&#8221;&gt;&lt;pre class=&#8221;line-numbers&#8221;&gt;<span class="line-number">1</span>
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#8217;code&#8217;&gt;&lt;pre&gt;<code class="ruby"><span class="line">  <span class="n">has_many</span> <span class="ss">:reverse_relationships</span><span class="p">,</span> <span class="n">foreign_key</span><span class="p">:</span> <span class="s2">&quot;followed_id&quot;</span><span class="p">,</span> <span class="n">class_name</span><span class="p">:</span> <span class="s2">&quot;Relationship&quot;</span>
</span></code>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</figure></notextile>&lt;/div&gt;
because otherwise Rails would look for a ReverseRelationship class, which doesn&rsquo;t exist.</p>

<p>In the case of a :followers attribute, Rails will singularize &ldquo;followers&rdquo; and automatically look for the foreign key followerid in this case. I&rsquo;ve kept the :source key to emphasize the parallel structure with the has_many :followed_users association, but you are free to leave it off.</p>

  
    <footer>
      <p class="meta">
        
        








  


<time datetime="2013-12-26T07:21:00-08:00" pubdate data-updated="true">Dec 26<span>th</span>, 2013</time>
        
      </p>
      
        <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://wubr2000.github.io/portfolio/Bites/index.html" data-via="wubr2000" data-counturl="http://wubr2000.github.io/portfolio/Bites/index.html" >Tweet</a>
  
  
  
</div>

      
    </footer>
  
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/27/bayesian-invasion/">A Gentle Gradient Descent</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/04/tapir/">Installing the Tapir Search Plugin for Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/29/monty-hall-simulation/">Solving the Monty Hall Problem Using Monte Carlo Simulation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/29/exploring-nlp-in-python/">Exploring NLP in Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/code-snippets-test/">Code Snippets Test</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/wubr2000">@wubr2000</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'wubr2000',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Bruno Wu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/vladigleba/readify">Readify</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
